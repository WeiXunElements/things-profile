<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">

<link rel="import" href="../things-global-behavior/things-global-behavior.html">
<link rel="import" href="../things-i18n-msg/things-i18n-msg.html">

<link rel="import" href="things-profile-dialog.html">

<!--
	프로파일 컴포넌트
-->

<dom-module id="things-profile">
	<template>
		<style>
			:host {
				display: inline-block;
				background-color: var(--things-secondary-background-color);
				color: rgba(255, 255, 255, .8);
			}

			paper-icon-button {
				@apply(--things-small-icon);
				margin-right: 3px;
			}
		</style>

		<things-i18n-msg msgid="button.profile" msg="{{labelProfile}}" auto hidden>profile</things-i18n-msg>

		<paper-icon-button id="account" icon="icons:account-circle" hidden="[[buttonEnable]]" title="[[labelProfile]]" on-tap="open">
		</paper-icon-button>{{globals.user.name}}

		<things-profile-dialog id="dialog" system="[[system]]" role-list-url="[[roleListUrl]]" role-request-url="[[roleRequestUrl]]" hidden="[[buttonEnable]]"></things-profile-dialog>
	</template>

	<script>
		Polymer({
			is: 'things-profile',

			properties: {
				/**
				 * 버튼 활성화 여부 
				 */
				buttonEnable: {
					type: Boolean,
					computed: '_isSignedIn(globals.user.name)'
				},

				/**
				 * 시스템 명 
				 */
				system: {
					type: String
				},

				/**
				 * 권한 요청 URL
				 */
				roleRequestUrl: {
					type: String
				},

				/**
				 * 역할 리스트 조회 URL
				 */
				roleListUrl: {
					type: String
				}
			},

			behaviors: [
				Things.GlobalBehavior
			],

			/**
			 * Profile Dialog를 오픈한다.
			 */
			open: function() {
				this.$.dialog.open()
			},

			/**
			 * 로그인 된 상황인 지 체크 
			 */
			_isSignedIn: function(name) {
				return name ? false : true;
			}
		});

	</script>
</dom-module>